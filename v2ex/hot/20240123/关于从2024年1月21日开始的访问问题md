### 关于从 2024 年 1 月 21 日开始的访问问题

我不确定这是攻击还是某个插件的行为，很多的 IP 持续在以非常高的并发请求 /api/topics/show.json 这个接口。因为我一直没有安装过任何插件，所以我无法去确认这是否是任何插件造成的问题。只能针对这个访问特征当作攻击来应对了。

https://i.v2ex.co/994NxGKJ.png

---------------------------------------------------

我到现在才能访问进来。

---------------------------------------------------

难怪，一上午都访问不了，还以为 ip/号被 ban 了

---------------------------------------------------

我访问 v2ex.com 访问不了，我从 google 搜 V2EX 就能跳进来了

---------------------------------------------------

这两天有点不稳定，我还以为是我梯子的问题。

---------------------------------------------------

网页没问题，第三方客户端登录不了。

---------------------------------------------------

@shzbkzo @coolpace 这两位做插件的，赶紧看看？

---------------------------------------------------

我也是刚进来。

---------------------------------------------------

怪不得昨晚摸鱼的时候打不开了-。-

---------------------------------------------------

从昨晚开始访问异常，我想我也没干啥啊

---------------------------------------------------

@zhangqilin 是因为刚刚才恢复服务

---------------------------------------------------

我还认为是哪个大佬在 D 站

---------------------------------------------------

如果你有在用任何的插件，可以打开观察元素，切换到网络请求，看看是否有插件在频繁请求。

---------------------------------------------------

刚进来

---------------------------------------------------

终于进来了

---------------------------------------------------

211.75.30.240 台湾 IP ，上面绑了群晖的 DDNS ，像是个人用户在用，难不成做了服务向外提供代理，其他 IP 类似的话，代理池？

另外，json 文件应该是静态资源吧，不涉及后端的话，?id=<random>的形式应该构不成 CC 吧

如果同一时间大量。

有没有可能是某一插件出现错误然后导致的类 DDoS ？

---------------------------------------------------

目前，对于观察到会这样请求 /api/topics/show.json 的 IP ，会显示一个 block 页面。

---------------------------------------------------

同，总算刷新进来了。。

---------------------------------------------------

我用了 v2next,不知道会不会有影响，我看调用这个接口了

---------------------------------------------------

昨天在这里问了一个问题，晚上开始就异常了，刚才一直跳  cloudflare

请问站长还有别的方式反馈吗？这里进不来的话

---------------------------------------------------

有人在爬站点啊

---------------------------------------------------

通过代理访问的，提示 IP 被禁止访问。
看了一下，这个接口是获取话题展示信息？

这明显是爬虫，通过 IP 池抓取所有文章吧

---------------------------------------------------

@magic3584 https://discord.gg/GNUzSQQSYw

---------------------------------------------------

刚又挂了一会-。-

---------------------------------------------------

@Livid #12 我用的 V2EX-超级增强，看了下没啥异常请求-。-

---------------------------------------------------

总算进来了

---------------------------------------------------

V2Next 有很多请求

---------------------------------------------------

v2next 一开就封 IP 我换节点 1 秒封 关掉插件脚本好了

---------------------------------------------------

进来了，我以为我被 ban 了呢

---------------------------------------------------

V2NEXT 会请求 https://www.v2ex.com/api/topics/show.json?id=
但只会请求一次啊我看

---------------------------------------------------

@imnpc 
@boom520 
那估计就是这个了。作者在吗

---------------------------------------------------

@lchkid 目前 CF 上的 Rate Limit 设置是：

如果 10 秒内超过 5 个请求 /api/topics/show.json ，IP 会被 ban 一天。

https://i.v2ex.co/1p3OFk83.png

---------------------------------------------------

终于进来了

---------------------------------------------------

同 Rate Limit 。但是，是正常操作。
难道一下点了几帖子。

不能进 V2,好着急呀。

---------------------------------------------------

一整个早上进不来了，憋得慌。

---------------------------------------------------

@Livid #12 我观察 V2EX plus 五分钟，没有发现有任何发往这个 api 的请求。排除这个插件有问题

---------------------------------------------------

@KING754 收到，我试试把 Block 换成 CAPTCHA 。

---------------------------------------------------

没有插件和多余额外请求，但是每次刷新页面都会跳转 cloundflare

---------------------------------------------------

通过代理访问的，提示 IP 被禁止访问。
看了一下，这个接口是获取话题展示信息？

这应该是爬虫，通过 IP 池抓取所有文章吧

---------------------------------------------------

用的 V2Next ，在访问列表时，会大量请求 /api/topics/show.json ，可能是为了实现预览的效果

---------------------------------------------------

昨天我在 v2 发了个帖子，后面突然就进不来了。现在才卡进来，我还以为站凉了...

---------------------------------------------------

可能有些用户用的同一个机场的同一个 ip 出口吧，单个用户正常操作也会被连带封了

---------------------------------------------------

@Joker1201 这个叫做 V2Next 的插件从哪里可以下载到？

---------------------------------------------------

因为一些公司网络的原因，我需要挂代理才能访问 V 站（平时也是这样访问的）；

刚刚多刷新了几下，但是仍然显示被 ban ，换了一个代理服务器进来了

---------------------------------------------------

@Livid 下载地址： https://greasyfork.org/zh-CN/scripts/458024-v2next

---------------------------------------------------

@Livid https://greasyfork.org/zh-CN/scripts/458024-v2next

---------------------------------------------------

手机无法访问

---------------------------------------------------

@Livid #42 https://greasyfork.org/zh-CN/scripts/458024-v2next

---------------------------------------------------

同 V2Next 插件，打开列表的时候会大量请求 json ，关了就进来了

---------------------------------------------------

这两天都不能访问。

---------------------------------------------------

抓住元凶了
https://github.com/zyronon/web-scripts/blob/bee70bb97635968e4dbd6c8e2d600a5b5abb86f3/v2next/mobile/src/main.ts#L451

---------------------------------------------------

@54xavier 好快

---------------------------------------------------

终于进来了

---------------------------------------------------

@Livid https://github.com/zyronon/web-scripts/issues/65#issuecomment-1905229319

---------------------------------------------------

1

---------------------------------------------------

@Livid 站长您好，我是 V2Next 的脚本作者，脚本的确会请求很多次 show.json 这个接口，并不是在刻意攻击 V 站

脚本逻辑是：

1 、每次打开首页或者节点这种列表页面，脚本会解析列表中的所有主题拿到 id ，然后并发请求 show.json ，以获取接口返回的 content_rendered 这个字段。

2 、这个字段我主要用于 弹框显示主题时提前显示正文，和列表是卡片模式时提前预览正文

这个脚本是我今年 1 月份上传，这个 show.json 的逻辑也是一开始就存在的，并不是最近才加的功能，并不是在刻意攻击 V 站

可能是最近使用我这个脚本的 V 站用户比较多，我看这个统计数据 https://greasyfork.org/zh-CN/scripts/458024-v2next/stats ，最近一次脚本更新的人数有 1700 人，说明可能有 1000 以上的人在使用这个脚本，由于突然用户过多，导致请求数量也变的更多，所以被站长判定为攻击行为了

我已经把这个逻辑修改掉，现在不会并发请求 show.json 了，在此很抱歉给站长和各位 V 友带来困扰了

麻烦大家手动点击一下更新到 7.9.4 版本：这里是脚本地址： https://greasyfork.org/zh-CN/scripts/458024

---------------------------------------------------

用的 v2fun 客户端昨天也会出现访问不了的情况

---------------------------------------------------

好像恢复了，一下了主站也能进了

---------------------------------------------------

防止失联，可以加一下这里：

https://discord.gg/GNUzSQQSYw

---------------------------------------------------

还以为刚买的梯子翻车了

---------------------------------------------------

半天打不开，我还以为我的梯子跑路了🤣

---------------------------------------------------

我以为我被 ban 了，在用 android 的 V2er

---------------------------------------------------

换了个节点才进来

---------------------------------------------------

终于进来了，我还以为是自己的 IP 被 ban 了

---------------------------------------------------

额外讨论个技术问题：
类似 /api/topics/show.json?id= 这种请求，应该很好做缓存的，除非 id 是无序并且大量的

---------------------------------------------------

难怪我用 Chrome 一直登录不上，换 Safari 就可以了，原来是因为 Chrome 有插件

---------------------------------------------------

@Livid #31 昨天我大概率手动请求超过了这个阈值了 🤦‍♂️ 老是显示 524 错误，然后我就手动刷新。
（由于用的是付费机场梯子，不排除也有别人用同一个发 IP 请求。）

另外，V2EX Plus （关闭 vDaily ）没看到有额外请求。

---------------------------------------------------

加了群，防止下次失联不知道原因

---------------------------------------------------

现在应该都恢复了

---------------------------------------------------

iOS 客户端伟途亦可思还是不行

---------------------------------------------------

从上次那个大流量测试帖之后，访问一直时好时坏，用的火狐浏览器“FoxyProxy”代理插件，其他外站没问题

---------------------------------------------------

上午一直没打开

---------------------------------------------------

還是不穩定

---------------------------------------------------

刚才又挂了一会

---------------------------------------------------

好像还是不太稳定

---------------------------------------------------

没有装任何插件，一上午打不开，还提示被 ban 了。。

---------------------------------------------------

我说今天热门帖子怎么这么少呢😂

---------------------------------------------------

我以为我 ip 被 ban 了。。

---------------------------------------------------

还是不太行，刚才才进来

---------------------------------------------------

我还以为是自己的机场寄了

---------------------------------------------------

终于上来了

---------------------------------------------------

选插件还是也要选懂技术的。。。

---------------------------------------------------

终于进来了

---------------------------------------------------

终于进来啦

---------------------------------------------------

上午加载好卡

---------------------------------------------------

刚刚又挂了一会

---------------------------------------------------

已经卡了两天了，现在终于好了。。

---------------------------------------------------

/t/939839 一年一次

---------------------------------------------------

啊！我的精神家园终于恢复了！！

---------------------------------------------------

被攻击了

---------------------------------------------------

还奇怪这两天很卡

---------------------------------------------------

终于进来了。

---------------------------------------------------

终于进来了 上午都不知道去哪里摸鱼了

---------------------------------------------------

终于进来了

---------------------------------------------------

好家伙，原来不能摸鱼这么难受😀😀

---------------------------------------------------

@Livid 能不能回复下邮件，被屏蔽的莫名其妙

---------------------------------------------------

V2EX Polish 插件没发现问题

---------------------------------------------------

担心的问题，还是发生了： https://i.imgur.com/TwJuGvF.png

---------------------------------------------------

https://i.imgur.com/agAJ0Rd.png 今年来的有点早啊

---------------------------------------------------

站长可以考虑动态分离，做个主动缓存，抗攻击很容易。

匿名可访问的公开帖子全部缓存到 CF ，在页面通过 AJAX 加载最新内容，每次编辑帖子、回复帖子就主动更新缓存。这样用户访问就有 CDN 静态 HTML+后端 AJAX 动态请求，万一后端挂了，已经缓存的页面不影响访问的。而后端正常的时候，AJAX 刷新页面，也不影响用户查看最新内容，体验是一样的。

---------------------------------------------------

@coolpace 我看过你这句话。

---------------------------------------------------

@Livid #58 想请问 v 站为何也要验证手机号？

---------------------------------------------------

这个问题准备怎么解决？禁用 V2Next 吗？

---------------------------------------------------

已当前页面为例，刷新页面   https://i.imgur.com/FCWYF9T.png 

打开插件  https://i.imgur.com/8KaevuX.png 

 https://i.imgur.com/KuJiTNL.png

---------------------------------------------------

@vueli #100  油猴的 V2Next 插件

---------------------------------------------------

进来了, 昨天下午就进不来了, 还以为被 ban 了

---------------------------------------------------

上午没得 V2EX 的时间，我的效率都变高了😹

---------------------------------------------------

以为怎么了呢，一直验证

---------------------------------------------------

可是我什么都没挂，还是到下午才进来....

---------------------------------------------------

过年了无心工作，摸鱼人数过多（手动狗头）

---------------------------------------------------

这么多人啦

---------------------------------------------------

打开 Tampermonkey 上的 v2Next 插件后 浏览器大量发出到 show.json?id=101xxx 的请求
 https://i.imgur.com/r9aRTMw.png 
关闭后就没了

---------------------------------------------------

@shuson 贴错了，怎么删除

---------------------------------------------------

@shuson #112 v2 没有删除功能

---------------------------------------------------

@coolpace #97 老哥是厚道人，喜欢用你的插件 https://i.imgur.com/pmNOo2w.png

---------------------------------------------------

@TAFMT 被回复的人 可以删除回复

---------------------------------------------------

终于可以登上了

---------------------------------------------------

@coolpace 不如做成捐赠功能？一半转赠到 V2EX ，这些钱可以 cover 掉服务器多出来的负担

---------------------------------------------------

终于进来了

---------------------------------------------------

@NeedMe123456 #102 V2Next 已经更新了

---------------------------------------------------

@noahhhh 我还想 V2EX 给我的插件捐赠呢哈哈哈🤣

---------------------------------------------------

@shuson #115 被回复的人可以删除他收到的回复提醒，除了管理员，谁都删不了发出来的东西。

---------------------------------------------------

终于进来了 不容易啊

---------------------------------------------------

刚进来，签个到。

---------------------------------------------------

下午还以为是自己的梯子挂了

---------------------------------------------------

我以为 ip 被 ban 了，换 4g 还是不行

---------------------------------------------------

还以为把我拉黑了！

---------------------------------------------------

昨晚下班后开始报 524 ，提示 CF 回源到 V2EX 超时，换了几个梯子进不来，还以为是我网络问题咧。

---------------------------------------------------

这是跟腾讯学习哪，各种安全检查导致我都登录不上 QQ 了，索性就不用了。

---------------------------------------------------

終於進來了

---------------------------------------------------

换了一个插件

---------------------------------------------------

我昨天还以为 IP 全被 ban 了...似曾相识的场景

---------------------------------------------------

@Livid 您好请问我的账号为什么访问 V2EX 特定页面（目前已知首页和部分节点）会自动跳转到 Google ？例如我直接输入首页 https://www.v2ex.com/ 就会被重定向到 Google ，而退出账号登陆则能正常访问。

---------------------------------------------------

我还以为是我的问题……

---------------------------------------------------

@shzbkzo #55 请求的脚本已被删除。。。

---------------------------------------------------

V2Next 作者已经删库跑路了 https://i.imgur.com/krir4IG.png

---------------------------------------------------

说来也怪，这两天 javbus 也登不上，v2ex 恢复，那边也恢复了，我还以为你们是一个人开发的托管在同一台服务器呢

---------------------------------------------------

@username1919810 因为你在你自己的设置里这么填的：

https://www.v2ex.com/settings

---------------------------------------------------

@Livid #137 谢谢！不知道什么时候设置上去的😂

---------------------------------------------------

@shuson #115 被回复的人可以删除他收到的回复提醒，除了管理员，谁都删不了发出来的东西。

---------------------------------------------------

终于进来了 不容易啊

---------------------------------------------------

刚进来，签个到。

---------------------------------------------------

下午还以为是自己的梯子挂了

---------------------------------------------------

我以为 ip 被 ban 了，换 4g 还是不行

---------------------------------------------------

还以为把我拉黑了！

---------------------------------------------------

昨晚下班后开始报 524 ，提示 CF 回源到 V2EX 超时，换了几个梯子进不来，还以为是我网络问题咧。

---------------------------------------------------

这是跟腾讯学习哪，各种安全检查导致我都登录不上 QQ 了，索性就不用了。

---------------------------------------------------

終於進來了

---------------------------------------------------

换了一个插件

---------------------------------------------------

我昨天还以为 IP 全被 ban 了...似曾相识的场景

---------------------------------------------------

@Livid 您好请问我的账号为什么访问 V2EX 特定页面（目前已知首页和部分节点）会自动跳转到 Google ？例如我直接输入首页 https://www.v2ex.com/ 就会被重定向到 Google ，而退出账号登陆则能正常访问。

---------------------------------------------------

我还以为是我的问题……

---------------------------------------------------

@shzbkzo #55 请求的脚本已被删除。。。

---------------------------------------------------

V2Next 作者已经删库跑路了 https://i.imgur.com/krir4IG.png

---------------------------------------------------

说来也怪，这两天 javbus 也登不上，v2ex 恢复，那边也恢复了，我还以为你们是一个人开发的托管在同一台服务器呢

---------------------------------------------------

@username1919810 因为你在你自己的设置里这么填的：

https://www.v2ex.com/settings

---------------------------------------------------

@Livid #137 谢谢！不知道什么时候设置上去的😂

---------------------------------------------------

@shuson #115 被回复的人可以删除他收到的回复提醒，除了管理员，谁都删不了发出来的东西。

---------------------------------------------------

终于进来了 不容易啊

---------------------------------------------------

刚进来，签个到。

---------------------------------------------------

下午还以为是自己的梯子挂了

---------------------------------------------------

我以为 ip 被 ban 了，换 4g 还是不行

---------------------------------------------------

还以为把我拉黑了！

---------------------------------------------------

昨晚下班后开始报 524 ，提示 CF 回源到 V2EX 超时，换了几个梯子进不来，还以为是我网络问题咧。

---------------------------------------------------

这是跟腾讯学习哪，各种安全检查导致我都登录不上 QQ 了，索性就不用了。

---------------------------------------------------

終於進來了

---------------------------------------------------

换了一个插件

---------------------------------------------------

我昨天还以为 IP 全被 ban 了...似曾相识的场景

---------------------------------------------------

@Livid 您好请问我的账号为什么访问 V2EX 特定页面（目前已知首页和部分节点）会自动跳转到 Google ？例如我直接输入首页 https://www.v2ex.com/ 就会被重定向到 Google ，而退出账号登陆则能正常访问。

---------------------------------------------------

我还以为是我的问题……

---------------------------------------------------

@shzbkzo #55 请求的脚本已被删除。。。

---------------------------------------------------

V2Next 作者已经删库跑路了 https://i.imgur.com/krir4IG.png

---------------------------------------------------

说来也怪，这两天 javbus 也登不上，v2ex 恢复，那边也恢复了，我还以为你们是一个人开发的托管在同一台服务器呢

---------------------------------------------------

@username1919810 因为你在你自己的设置里这么填的：

https://www.v2ex.com/settings

---------------------------------------------------

@Livid #137 谢谢！不知道什么时候设置上去的😂

---------------------------------------------------

@shuson #115 被回复的人可以删除他收到的回复提醒，除了管理员，谁都删不了发出来的东西。

---------------------------------------------------

终于进来了 不容易啊

---------------------------------------------------

刚进来，签个到。

---------------------------------------------------

下午还以为是自己的梯子挂了

---------------------------------------------------

我以为 ip 被 ban 了，换 4g 还是不行

---------------------------------------------------

还以为把我拉黑了！

---------------------------------------------------

昨晚下班后开始报 524 ，提示 CF 回源到 V2EX 超时，换了几个梯子进不来，还以为是我网络问题咧。

---------------------------------------------------

这是跟腾讯学习哪，各种安全检查导致我都登录不上 QQ 了，索性就不用了。

---------------------------------------------------

終於進來了

---------------------------------------------------

换了一个插件

---------------------------------------------------

我昨天还以为 IP 全被 ban 了...似曾相识的场景

---------------------------------------------------

@Livid 您好请问我的账号为什么访问 V2EX 特定页面（目前已知首页和部分节点）会自动跳转到 Google ？例如我直接输入首页 https://www.v2ex.com/ 就会被重定向到 Google ，而退出账号登陆则能正常访问。

---------------------------------------------------

我还以为是我的问题……

---------------------------------------------------

@shzbkzo #55 请求的脚本已被删除。。。

---------------------------------------------------

V2Next 作者已经删库跑路了 https://i.imgur.com/krir4IG.png

---------------------------------------------------

说来也怪，这两天 javbus 也登不上，v2ex 恢复，那边也恢复了，我还以为你们是一个人开发的托管在同一台服务器呢

---------------------------------------------------

@username1919810 因为你在你自己的设置里这么填的：

https://www.v2ex.com/settings

---------------------------------------------------

@Livid #137 谢谢！不知道什么时候设置上去的😂

